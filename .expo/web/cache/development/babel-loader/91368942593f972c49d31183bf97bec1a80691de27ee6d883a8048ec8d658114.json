{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Documents\\\\Tricade\\\\src\\\\views\\\\ProfileScreen.js\";\nimport React, { useState, useEffect, createContext, useContext, useRef } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport RetroButton from '../components/RetroButton';\nimport userPinkIcon from '../assets/user-pink.png';\nimport { auth, db, storage } from '../firebaseConfig';\nimport { updateProfile, onAuthStateChanged, signOut } from 'firebase/auth';\nimport { ref, uploadBytes, getDownloadURL, getStorage } from 'firebase/storage';\nimport * as ImagePicker from 'expo-image-picker';\nimport { doc, getDoc, setDoc, increment, updateDoc } from 'firebase/firestore';\nimport editarRosaIcon from '../assets/editar_rosa.png';\nimport { screenWidth as width, screenHeight as height, wp, hp, SPACING, FONT_SIZES, scaleDimension, scaleFont, getResponsiveDimension } from '../utils/dimensions';\nimport { Audio } from 'expo-av';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { AudioContext } from '../../App';\nimport BottomTabBar from '../components/BottomTabBar';\nimport { GAME_SCORES, getExpForLevel, SPECIAL_AVATARS } from '../utils/scoreConfig';\nimport { checkAndUpdateMissions } from '../utils/missions';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar pixelFont = 'PressStart2P_400Regular';\nvar pixelStroke = [{\n  textShadowOffset: {\n    width: -4,\n    height: 0\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: 4,\n    height: 0\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: 0,\n    height: -4\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: 0,\n    height: 4\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: -4,\n    height: -4\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: 4,\n    height: -4\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: -4,\n    height: 4\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}, {\n  textShadowOffset: {\n    width: 4,\n    height: 4\n  },\n  textShadowColor: '#000',\n  textShadowRadius: 0\n}];\nvar defaultAvatar = require('../assets/user-pink.png');\nvar avatarOptions = [require('../assets/user-blue.png'), require('../assets/user-pink.png')];\nvar audioOnIcon = require('../assets/audio-on.png');\nvar audioOffIcon = require('../assets/audio-off.png');\nvar audioGame = require('../assets/audio-game.mp3');\nvar audioPapi = require('../assets/audio-papi.mp3');\nexport var UserCacheContext = createContext();\nexport function useUserCache() {\n  return useContext(UserCacheContext);\n}\nexport default function ProfileScreen(_ref) {\n  var _this = this;\n  var navigation = _ref.navigation,\n    isTab = _ref.isTab;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    currentUser = _useState2[0],\n    setCurrentUser = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    username = _useState4[0],\n    setUsername = _useState4[1];\n  var _useState5 = useState(userPinkIcon),\n    _useState6 = _slicedToArray(_useState5, 2),\n    avatar = _useState6[0],\n    setAvatar = _useState6[1];\n  var _useState7 = useState(0),\n    _useState8 = _slicedToArray(_useState7, 2),\n    level = _useState8[0],\n    setLevel = _useState8[1];\n  var _useState9 = useState(0),\n    _useState0 = _slicedToArray(_useState9, 2),\n    exp = _useState0[0],\n    setExp = _useState0[1];\n  var _useState1 = useState(600),\n    _useState10 = _slicedToArray(_useState1, 2),\n    expMax = _useState10[0],\n    setExpMax = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    modalVisible = _useState12[0],\n    setModalVisible = _useState12[1];\n  var _useState13 = useState(''),\n    _useState14 = _slicedToArray(_useState13, 2),\n    editName = _useState14[0],\n    setEditName = _useState14[1];\n  var _useState15 = useState(null),\n    _useState16 = _slicedToArray(_useState15, 2),\n    editAvatar = _useState16[0],\n    setEditAvatar = _useState16[1];\n  var _useState17 = useState(0),\n    _useState18 = _slicedToArray(_useState17, 2),\n    selectedAvatarIndex = _useState18[0],\n    setSelectedAvatarIndex = _useState18[1];\n  var _useState19 = useState(false),\n    _useState20 = _slicedToArray(_useState19, 2),\n    loggingOut = _useState20[0],\n    setLoggingOut = _useState20[1];\n  var _useState21 = useState(null),\n    _useState22 = _slicedToArray(_useState21, 2),\n    userCache = _useState22[0],\n    setUserCache = _useState22[1];\n  var _useContext = useContext(AudioContext),\n    audioOn = _useContext.audioOn,\n    toggleAudio = _useContext.toggleAudio;\n  var fadeAnim = useRef(new Animated.Value(1)).current;\n  var _useState23 = useState(false),\n    _useState24 = _slicedToArray(_useState23, 2),\n    showAvatarModal = _useState24[0],\n    setShowAvatarModal = _useState24[1];\n  var audioRef = useRef(null);\n  var audioElementRef = useRef(null);\n  useEffect(function () {\n    var unsubscribe = onAuthStateChanged(auth, function () {\n      var _ref2 = _asyncToGenerator(function* (user) {\n        try {\n          if (user) {\n            setCurrentUser(user);\n            var displayName = user.displayName;\n            var userLevel = 0;\n            var userExp = 0;\n            try {\n              var userDoc = yield getDoc(doc(db, 'users', user.uid));\n              if (userDoc.exists()) {\n                var _data$level, _data$exp;\n                var data = userDoc.data();\n                displayName = data.displayName || displayName;\n                userLevel = (_data$level = data.level) != null ? _data$level : 0;\n                userExp = (_data$exp = data.exp) != null ? _data$exp : 0;\n                if (data.avatarSpecial) {\n                  var specialImg = null;\n                  if (data.avatarSpecial === 'hidden.1.jpg') specialImg = require('../assets/hidden.1.jpg');else if (data.avatarSpecial === 'hidden.2.jpg') specialImg = require('../assets/hidden.2.jpg');else if (data.avatarSpecial === 'hidden.3.jpg') specialImg = require('../assets/hidden.3.jpg');\n                  if (specialImg) setAvatar(specialImg);else if (user.photoURL) setAvatar({\n                    uri: user.photoURL\n                  });else setAvatar(userPinkIcon);\n                } else if (user.photoURL) {\n                  setAvatar({\n                    uri: user.photoURL\n                  });\n                } else {\n                  setAvatar(userPinkIcon);\n                }\n                if (displayName && user.displayName !== displayName) {\n                  yield updateProfile(user, {\n                    displayName: displayName\n                  });\n                }\n              }\n            } catch (firestoreError) {\n              console.warn('Error al conectar con Firestore:', firestoreError);\n              if (user.photoURL) {\n                setAvatar({\n                  uri: user.photoURL\n                });\n              } else {\n                setAvatar(userPinkIcon);\n              }\n            }\n            setUsername(displayName || '');\n            setEditName(displayName || '');\n            setLevel(userLevel);\n            setExp(userExp);\n            setUserCache({\n              uid: user.uid,\n              displayName: displayName,\n              level: userLevel,\n              exp: userExp,\n              photoURL: user.photoURL || null,\n              avatar: user.photoURL ? {\n                uri: user.photoURL\n              } : userPinkIcon\n            });\n          } else {\n            if (!isTab) {\n              navigation.replace && navigation.replace('Login');\n            } else {\n              setCurrentUser(null);\n            }\n            setUserCache(null);\n          }\n        } catch (error) {\n          console.error('Error en la autenticaciÃ³n:', error);\n          if (!isTab) {\n            navigation.replace && navigation.replace('Login');\n          } else {\n            setCurrentUser(null);\n          }\n          setUserCache(null);\n        }\n      });\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n    return function () {\n      unsubscribe();\n    };\n  }, [navigation, isTab]);\n  var activeTab = 'user';\n  if (navigation && navigation.getState) {\n    var route = navigation.getState().routes[navigation.getState().index];\n    if (route && route.name === 'Profile') activeTab = 'user';else if (route && route.name === 'Games') activeTab = 'home';else if (route && route.name === 'Home') activeTab = 'trophy';\n  }\n  var openEdit = function openEdit() {\n    var cache = userCache || {};\n    setEditName(cache.displayName || username);\n    setEditAvatar(cache.avatar || avatar);\n    setModalVisible(true);\n  };\n  var pickImage = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      if (Platform.OS === 'web') {\n        var input = document.createElement('input');\n        input.type = 'file';\n        input.accept = 'image/*';\n        input.onchange = function () {\n          var _ref4 = _asyncToGenerator(function* (e) {\n            var file = e.target.files[0];\n            if (file) {\n              try {\n                var _storage = getStorage();\n                var storageRef = ref(_storage, `avatars/${currentUser.uid}.jpg`);\n                yield uploadBytes(storageRef, file);\n                var url = yield getDownloadURL(storageRef);\n                yield updateProfile(currentUser, {\n                  photoURL: url\n                });\n                setAvatar({\n                  uri: url\n                });\n                if (currentUser && currentUser.uid) {\n                  yield setDoc(doc(db, 'users', currentUser.uid), {\n                    photoURL: url\n                  }, {\n                    merge: true\n                  });\n                }\n              } catch (error) {\n                console.error('Error al subir la imagen:', error);\n              }\n            }\n          });\n          return function (_x2) {\n            return _ref4.apply(this, arguments);\n          };\n        }();\n        input.click();\n      } else {\n        var result = yield ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images,\n          allowsEditing: true,\n          aspect: [1, 1],\n          quality: 0.7\n        });\n        if (!result.canceled && result.assets && result.assets.length > 0) {\n          var image = result.assets[0];\n          try {\n            var _storage2 = getStorage();\n            var storageRef = ref(_storage2, `avatars/${currentUser.uid}.jpg`);\n            var response = yield fetch(image.uri);\n            var blob = yield response.blob();\n            yield uploadBytes(storageRef, blob);\n            var url = yield getDownloadURL(storageRef);\n            yield updateProfile(currentUser, {\n              photoURL: url\n            });\n            setAvatar({\n              uri: url\n            });\n            if (currentUser && currentUser.uid) {\n              yield setDoc(doc(db, 'users', currentUser.uid), {\n                photoURL: url\n              }, {\n                merge: true\n              });\n            }\n          } catch (error) {\n            console.error('Error al subir la imagen:', error);\n          }\n        }\n      }\n    });\n    return function pickImage() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var saveEdit = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      var newName = editName.trim() ? editName : username;\n      setUsername(newName);\n      setAvatar(editAvatar);\n      setModalVisible(false);\n      yield updateProfile(currentUser, {\n        displayName: newName\n      });\n      if (currentUser && currentUser.uid) {\n        yield setDoc(doc(db, 'users', currentUser.uid), {\n          displayName: newName\n        }, {\n          merge: true\n        });\n      }\n    });\n    return function saveEdit() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var changeAvatarWithAnimation = function changeAvatarWithAnimation(newAvatar) {\n    Animated.sequence([Animated.timing(fadeAnim, {\n      toValue: 0,\n      duration: 500,\n      useNativeDriver: true\n    }), Animated.timing(fadeAnim, {\n      toValue: 1,\n      duration: 500,\n      useNativeDriver: true\n    })]).start();\n    setAvatar(newAvatar);\n  };\n  useEffect(function () {\n    if (showAvatarModal) {\n      if (Platform.OS === 'web') {\n        if (audioElementRef.current) {\n          audioElementRef.current.currentTime = 0;\n          audioElementRef.current.volume = 0.4;\n          audioElementRef.current.play();\n        }\n      } else {\n        _asyncToGenerator(function* () {\n          if (audioRef.current) {\n            yield audioRef.current.unloadAsync();\n          }\n          var _yield$Audio$Sound$cr = yield Audio.Sound.createAsync(audioPapi),\n            sound = _yield$Audio$Sound$cr.sound;\n          audioRef.current = sound;\n          yield sound.setVolumeAsync(0.4);\n          yield sound.playAsync();\n        })();\n      }\n    } else {\n      if (Platform.OS === 'web') {\n        if (audioElementRef.current) {\n          audioElementRef.current.pause();\n          audioElementRef.current.currentTime = 0;\n        }\n      } else {\n        if (audioRef.current) {\n          audioRef.current.unloadAsync();\n          audioRef.current = null;\n        }\n      }\n    }\n    return function () {\n      if (Platform.OS === 'web') {\n        if (audioElementRef.current) {\n          audioElementRef.current.pause();\n          audioElementRef.current.currentTime = 0;\n        }\n      } else {\n        if (audioRef.current) {\n          audioRef.current.unloadAsync();\n          audioRef.current = null;\n        }\n      }\n    };\n  }, [showAvatarModal]);\n  if (!currentUser) {\n    return _jsxDEV(SafeAreaView, {\n      style: {\n        flex: 1,\n        backgroundColor: '#0a0a23'\n      },\n      children: _jsxDEV(View, {\n        style: [styles.root, {\n          justifyContent: 'center',\n          alignItems: 'center'\n        }],\n        children: _jsxDEV(Text, {\n          style: [styles.title].concat(pixelStroke),\n          children: \"Cargando...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 7\n    }, this);\n  }\n  return _jsxDEV(UserCacheContext.Provider, {\n    value: userCache,\n    children: _jsxDEV(SafeAreaView, {\n      style: {\n        flex: 1,\n        backgroundColor: '#0a0a23'\n      },\n      children: _jsxDEV(View, {\n        style: styles.root,\n        children: [_jsxDEV(ScrollView, {\n          contentContainerStyle: [styles.scrollContent, {\n            paddingBottom: 120\n          }],\n          showsVerticalScrollIndicator: false,\n          children: [_jsxDEV(Text, {\n            style: [styles.title].concat(pixelStroke),\n            children: \"PERFIL DE USUARIO\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this), _jsxDEV(TouchableOpacity, {\n            activeOpacity: 0.8,\n            onPress: function onPress() {\n              return setShowAvatarModal(true);\n            },\n            children: _jsxDEV(Animated.View, {\n              style: [styles.avatarBox, {\n                opacity: fadeAnim\n              }],\n              children: _jsxDEV(Image, {\n                source: avatar,\n                style: styles.avatar,\n                resizeMode: \"contain\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this), _jsxDEV(View, {\n            style: styles.usernameBox,\n            children: _jsxDEV(Text, {\n              style: [styles.username].concat(pixelStroke),\n              children: username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 13\n          }, this), _jsxDEV(View, {\n            style: styles.levelBox,\n            children: [_jsxDEV(View, {\n              style: styles.levelRow,\n              children: [_jsxDEV(Text, {\n                style: styles.levelText,\n                children: [\"Nivel \", level]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 17\n              }, this), _jsxDEV(Text, {\n                style: styles.expText,\n                children: [\"Exp \", exp, \"/\", expMax]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this), _jsxDEV(View, {\n              style: styles.expBarBg,\n              children: _jsxDEV(View, {\n                style: [styles.expBarFill, {\n                  width: `${exp / expMax * 100}%`\n                }]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 369,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this), _jsxDEV(TouchableOpacity, {\n            style: styles.editBtn,\n            activeOpacity: 0.7,\n            onPress: openEdit,\n            disabled: !currentUser,\n            children: _jsxDEV(View, {\n              style: {\n                flexDirection: 'row',\n                alignItems: 'center',\n                justifyContent: 'center'\n              },\n              children: [_jsxDEV(Text, {\n                style: styles.editBtnText,\n                children: \"Editar perfil\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 17\n              }, this), _jsxDEV(Image, {\n                source: editarRosaIcon,\n                style: styles.editIcon,\n                resizeMode: \"contain\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this), _jsxDEV(TouchableOpacity, {\n            style: styles.editBtn,\n            activeOpacity: 0.7,\n            onPress: toggleAudio,\n            children: _jsxDEV(View, {\n              style: {\n                flexDirection: 'row',\n                alignItems: 'center',\n                justifyContent: 'center'\n              },\n              children: [_jsxDEV(Text, {\n                style: styles.editBtnText,\n                children: audioOn ? 'Apagar sonido' : 'Encender sonido'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 17\n              }, this), _jsxDEV(Image, {\n                source: audioOn ? audioOnIcon : audioOffIcon,\n                style: [styles.editIcon, {\n                  tintColor: audioOn ? '#ff2e7e' : '#aaa'\n                }],\n                resizeMode: \"contain\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 13\n          }, this), !loggingOut && _jsxDEV(RetroButton, {\n            title: \"Salir\",\n            onPress: _asyncToGenerator(function* () {\n              setLoggingOut(true);\n              yield signOut(auth);\n              setLoggingOut(false);\n              if (!isTab) {\n                navigation.replace && navigation.replace('Login');\n              } else {\n                setCurrentUser(null);\n              }\n            }),\n            style: [styles.logoutBtn, {\n              alignSelf: 'center',\n              width: '90%',\n              marginTop: 18\n            }],\n            textStyle: styles.logoutBtnText\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 15\n          }, this), _jsxDEV(Modal, {\n            visible: loggingOut,\n            transparent: true,\n            animationType: \"fade\",\n            children: _jsxDEV(View, {\n              style: styles.loadingOverlay,\n              children: _jsxDEV(View, {\n                style: styles.loadingBox,\n                children: [_jsxDEV(Text, {\n                  style: styles.loadingText,\n                  children: \"Cerrando sesi\\xF3n...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 420,\n                  columnNumber: 19\n                }, this), _jsxDEV(View, {\n                  style: {\n                    marginTop: 18\n                  },\n                  children: _jsxDEV(ActivityIndicator, {\n                    size: \"large\",\n                    color: \"#ff2e7e\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 422,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 421,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 13\n          }, this), _jsxDEV(Modal, {\n            visible: modalVisible,\n            animationType: \"fade\",\n            transparent: true,\n            onRequestClose: function onRequestClose() {\n              return setModalVisible(false);\n            },\n            children: _jsxDEV(View, {\n              style: styles.modalOverlay,\n              children: _jsxDEV(View, {\n                style: styles.modalBox,\n                children: !username || !avatar ? _jsxDEV(View, {\n                  style: {\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    height: 120\n                  },\n                  children: [_jsxDEV(ActivityIndicator, {\n                    size: \"large\",\n                    color: \"#00fff7\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 439,\n                    columnNumber: 23\n                  }, this), _jsxDEV(Text, {\n                    style: {\n                      color: '#00fff7',\n                      fontFamily: pixelFont,\n                      marginTop: 18\n                    },\n                    children: \"Cargando perfil...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 440,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 438,\n                  columnNumber: 21\n                }, this) : _jsxDEV(_Fragment, {\n                  children: [_jsxDEV(Text, {\n                    style: [styles.modalTitle].concat(pixelStroke),\n                    children: \"Editar perfil\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 444,\n                    columnNumber: 23\n                  }, this), _jsxDEV(View, {\n                    style: styles.modalAvatarRow,\n                    children: avatarOptions.map(function (img, i) {\n                      return _jsxDEV(Pressable, {\n                        onPress: function onPress() {\n                          return setEditAvatar(img);\n                        },\n                        style: [styles.modalAvatarOption, editAvatar === img && styles.modalAvatarActive],\n                        children: _jsxDEV(Image, {\n                          source: img,\n                          style: styles.modalAvatarImg,\n                          resizeMode: \"contain\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 448,\n                          columnNumber: 29\n                        }, _this)\n                      }, i, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 447,\n                        columnNumber: 27\n                      }, _this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 445,\n                    columnNumber: 23\n                  }, this), _jsxDEV(TextInput, {\n                    style: styles.modalInput,\n                    value: editName,\n                    onChangeText: setEditName,\n                    maxLength: 16,\n                    placeholder: \"Nombre de usuario\",\n                    placeholderTextColor: \"#00fff7\",\n                    autoFocus: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 452,\n                    columnNumber: 23\n                  }, this), _jsxDEV(TouchableOpacity, {\n                    onPress: pickImage,\n                    style: styles.editAvatarBtn,\n                    children: _jsxDEV(Text, {\n                      style: styles.editAvatarBtnText,\n                      children: \"Elegir foto de galer\\xEDa\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 462,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 461,\n                    columnNumber: 23\n                  }, this), _jsxDEV(View, {\n                    style: styles.modalBtnRowColumn,\n                    children: [_jsxDEV(RetroButton, {\n                      title: \"Guardar\",\n                      onPress: saveEdit\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 465,\n                      columnNumber: 25\n                    }, this), _jsxDEV(RetroButton, {\n                      title: \"Cancelar\",\n                      onPress: function onPress() {\n                        return setModalVisible(false);\n                      },\n                      style: styles.cancelBtn,\n                      textStyle: styles.cancelBtnText\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 466,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 464,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 13\n          }, this), _jsxDEV(Modal, {\n            visible: showAvatarModal,\n            transparent: true,\n            animationType: \"fade\",\n            onRequestClose: function onRequestClose() {\n              return setShowAvatarModal(false);\n            },\n            children: _jsxDEV(View, {\n              style: styles.modalOverlay,\n              children: _jsxDEV(View, {\n                style: {\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                },\n                children: [_jsxDEV(Image, {\n                  source: avatar,\n                  style: {\n                    width: 220,\n                    height: 220,\n                    borderRadius: 24,\n                    borderWidth: 4,\n                    borderColor: '#00fff7',\n                    backgroundColor: '#23233a'\n                  },\n                  resizeMode: \"contain\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 483,\n                  columnNumber: 19\n                }, this), Platform.OS === 'web' && _jsxDEV(\"audio\", {\n                  ref: audioElementRef,\n                  src: require('../assets/audio-papi.mp3')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 486,\n                  columnNumber: 21\n                }, this), _jsxDEV(TouchableOpacity, {\n                  onPress: function onPress() {\n                    return setShowAvatarModal(false);\n                  },\n                  style: {\n                    marginTop: 24,\n                    backgroundColor: '#ff2e7e',\n                    borderRadius: 12,\n                    paddingVertical: 10,\n                    paddingHorizontal: 32\n                  },\n                  children: _jsxDEV(Text, {\n                    style: {\n                      color: '#fff',\n                      fontFamily: pixelFont,\n                      fontSize: 16\n                    },\n                    children: \"Cerrar\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 489,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 488,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 11\n        }, this), !isTab && _jsxDEV(BottomTabBar, {\n          activeTab: activeTab,\n          onTabPress: function onTabPress(tab) {\n            if (tab === 'trophy') navigation.navigate('Home');\n            if (tab === 'home') navigation.navigate('Games');\n            if (tab === 'user') navigation.navigate('Profile');\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 343,\n    columnNumber: 5\n  }, this);\n}\nexport function addTrikiWinExp() {\n  return _addTrikiWinExp.apply(this, arguments);\n}\nfunction _addTrikiWinExp() {\n  _addTrikiWinExp = _asyncToGenerator(function* () {\n    if (!auth.currentUser) return;\n    var userRef = doc(db, 'users', auth.currentUser.uid);\n    var userDoc = yield getDoc(userRef);\n    var exp = 0,\n      level = 0;\n    if (userDoc.exists()) {\n      exp = userDoc.data().exp || 0;\n      level = userDoc.data().level || 0;\n    }\n    exp += GAME_SCORES.triki;\n    var newLevel = level;\n    var expMax = getExpForLevel(newLevel + 1);\n    if (exp >= expMax) {\n      exp -= expMax;\n      newLevel += 1;\n    }\n    var updates = {\n      exp: exp,\n      level: newLevel\n    };\n    var special = SPECIAL_AVATARS.find(function (a) {\n      return a.level === newLevel;\n    });\n    if (special) {\n      updates.photoURL = null;\n      updates.avatarSpecial = special.image;\n    }\n    yield setDoc(userRef, updates, {\n      merge: true\n    });\n    var statsRef = doc(db, 'users', auth.currentUser.uid, 'trikiStats', 'stats');\n    var statsDoc = yield getDoc(statsRef);\n    var prev = {\n      victorias: 0,\n      derrotas: 0\n    };\n    if (statsDoc.exists()) {\n      prev = statsDoc.data();\n    }\n    yield setDoc(statsRef, {\n      victorias: prev.victorias + 1,\n      derrotas: prev.derrotas\n    }, {\n      merge: true\n    });\n    var missionReward = yield checkAndUpdateMissions(auth.currentUser.uid, 'TRIKI', {\n      victorias: prev.victorias + 1,\n      derrotas: prev.derrotas\n    });\n    if (missionReward > 0) {\n      yield updateDoc(userRef, {\n        level: increment(missionReward)\n      });\n    }\n  });\n  return _addTrikiWinExp.apply(this, arguments);\n}\nvar styles = StyleSheet.create({\n  root: {\n    flex: 1,\n    backgroundColor: '#0a0a23',\n    alignItems: 'center',\n    justifyContent: 'flex-start',\n    paddingTop: height * 0.04,\n    paddingBottom: 0,\n    width: '100%',\n    alignSelf: 'center'\n  },\n  title: {\n    color: '#fff',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.07, 22),\n    letterSpacing: 2,\n    marginBottom: height * 0.025,\n    textAlign: 'center'\n  },\n  avatarBox: {\n    borderWidth: width * 0.015,\n    borderColor: '#00fff7',\n    borderRadius: width * 0.08,\n    padding: width * 0.02,\n    backgroundColor: '#23233a',\n    alignSelf: 'center',\n    marginBottom: height * 0.018,\n    shadowColor: '#00fff7',\n    shadowOpacity: 0.45,\n    shadowRadius: 16,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    }\n  },\n  avatar: {\n    width: Math.min(width * 0.28, 80),\n    height: Math.min(width * 0.28, 80),\n    borderRadius: width * 0.06\n  },\n  usernameBox: {\n    alignSelf: 'center',\n    marginVertical: height * 0.012,\n    borderWidth: width * 0.01,\n    borderColor: '#00fff7',\n    borderRadius: width * 0.03,\n    paddingHorizontal: width * 0.04,\n    paddingVertical: height * 0.01,\n    backgroundColor: '#23233a'\n  },\n  username: {\n    color: '#00fff7',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.055, 18),\n    textAlign: 'center'\n  },\n  levelBox: {\n    width: '90%',\n    alignSelf: 'center',\n    marginVertical: height * 0.018,\n    borderWidth: width * 0.01,\n    borderColor: '#00fff7',\n    borderRadius: width * 0.04,\n    backgroundColor: '#23233a',\n    padding: width * 0.03\n  },\n  levelRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 6\n  },\n  levelText: {\n    color: '#ff2e7e',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.045, 14)\n  },\n  expText: {\n    color: '#ff2e7e',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.035, 12)\n  },\n  expBarBg: {\n    width: '100%',\n    height: Math.max(10, height * 0.015),\n    backgroundColor: '#101926',\n    borderRadius: width * 0.03,\n    overflow: 'hidden',\n    borderWidth: width * 0.008,\n    borderColor: '#ff2e7e'\n  },\n  expBarFill: {\n    height: '100%',\n    backgroundColor: '#ff2e7e',\n    borderRadius: width * 0.03\n  },\n  editBtn: {\n    width: '90%',\n    alignSelf: 'center',\n    marginTop: height * 0.012,\n    marginBottom: height * 0.012,\n    borderWidth: width * 0.01,\n    borderColor: '#00fff7',\n    borderRadius: width * 0.03,\n    backgroundColor: '#101926',\n    paddingVertical: height * 0.018,\n    paddingHorizontal: width * 0.04\n  },\n  editBtnText: {\n    color: '#fff',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.038, 13),\n    textAlign: 'center'\n  },\n  bottomTab: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    width: '94%',\n    backgroundColor: 'transparent',\n    borderRadius: width * 0.045,\n    borderWidth: width * 0.01,\n    borderColor: '#00fff7',\n    paddingVertical: height * 0.012,\n    paddingHorizontal: width * 0.045,\n    alignSelf: 'center',\n    marginTop: 'auto',\n    shadowColor: '#00fff7',\n    shadowOpacity: 0.25,\n    shadowRadius: 10,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    }\n  },\n  tabBtn: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: height * 0.012,\n    minHeight: 40\n  },\n  tabBtnActive: {\n    borderBottomWidth: 4,\n    borderBottomColor: '#ff2e7e',\n    shadowColor: '#ff2e7e',\n    shadowOpacity: 0.7,\n    shadowRadius: 10,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    }\n  },\n  tabIcon: {\n    width: width * 0.09,\n    height: width * 0.09\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(10,10,35,0.92)',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  modalBox: {\n    width: Math.min(width * 0.88, 340),\n    backgroundColor: '#23233a',\n    borderRadius: Math.max(18, width * 0.045),\n    borderWidth: 4,\n    borderColor: '#00fff7',\n    padding: 22,\n    alignItems: 'center',\n    shadowColor: '#00fff7',\n    shadowOpacity: 0.45,\n    shadowRadius: 16,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    }\n  },\n  modalTitle: {\n    color: '#ff2e7e',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.055, 22),\n    marginBottom: 18,\n    textAlign: 'center'\n  },\n  modalAvatarRow: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: 18,\n    gap: 12\n  },\n  modalAvatarOption: {\n    borderWidth: 2,\n    borderColor: '#00fff7',\n    borderRadius: 16,\n    padding: 4,\n    marginHorizontal: 6,\n    backgroundColor: '#101926'\n  },\n  modalAvatarActive: {\n    borderColor: '#ff2e7e',\n    backgroundColor: '#18182e',\n    shadowColor: '#ff2e7e',\n    shadowOpacity: 0.7,\n    shadowRadius: 8,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    }\n  },\n  modalAvatarImg: {\n    width: 48,\n    height: 48,\n    borderRadius: 12\n  },\n  modalInput: {\n    width: '90%',\n    borderWidth: 2,\n    borderColor: '#00fff7',\n    borderRadius: 10,\n    backgroundColor: '#101926',\n    color: '#00fff7',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.045, 18),\n    paddingVertical: 10,\n    paddingHorizontal: 12,\n    marginBottom: 18,\n    textAlign: 'center'\n  },\n  modalBtnRowColumn: {\n    flexDirection: 'column',\n    width: '100%',\n    gap: 10,\n    marginTop: 8\n  },\n  editAvatarBtn: {\n    marginTop: 10,\n    marginBottom: 10,\n    paddingVertical: 8,\n    paddingHorizontal: 18,\n    borderRadius: 8,\n    borderWidth: 2,\n    borderColor: '#00fff7',\n    backgroundColor: '#181828',\n    alignSelf: 'center'\n  },\n  editAvatarBtnText: {\n    color: '#00fff7',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.038, 16),\n    textAlign: 'center'\n  },\n  cancelBtn: {\n    backgroundColor: '#ff2e7e',\n    borderColor: '#ff2e7e',\n    marginTop: 6\n  },\n  cancelBtnText: {\n    color: '#fff',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.038, 16),\n    textAlign: 'center'\n  },\n  logoutBtn: {\n    backgroundColor: '#ff2e7e',\n    borderColor: '#ff2e7e',\n    marginTop: 16\n  },\n  logoutBtnText: {\n    color: '#fff',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.038, 16),\n    textAlign: 'center'\n  },\n  loadingOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(10,10,35,0.92)',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  loadingBox: {\n    backgroundColor: '#23233a',\n    borderRadius: 18,\n    borderWidth: 4,\n    borderColor: '#ff2e7e',\n    padding: 32,\n    alignItems: 'center',\n    shadowColor: '#ff2e7e',\n    shadowOpacity: 0.45,\n    shadowRadius: 16,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    }\n  },\n  loadingText: {\n    color: '#ff2e7e',\n    fontFamily: pixelFont,\n    fontSize: Math.min(width * 0.045, 18),\n    textAlign: 'center',\n    marginBottom: 8\n  },\n  editIcon: {\n    width: 28,\n    height: 28,\n    marginLeft: 14,\n    marginBottom: -3\n  },\n  cornerDotTL: {\n    position: 'absolute',\n    top: hp(2.5),\n    left: wp(4),\n    width: scaleDimension(12),\n    height: scaleDimension(12),\n    backgroundColor: '#ff2e7e',\n    borderRadius: scaleDimension(6),\n    zIndex: 2\n  },\n  cornerDotTR: {\n    position: 'absolute',\n    top: hp(2.5),\n    right: wp(4),\n    width: scaleDimension(12),\n    height: scaleDimension(12),\n    backgroundColor: '#00fff7',\n    borderRadius: scaleDimension(6),\n    zIndex: 2\n  },\n  cornerDotBL: {\n    position: 'absolute',\n    bottom: hp(2.5),\n    left: wp(4),\n    width: scaleDimension(12),\n    height: scaleDimension(12),\n    backgroundColor: '#00fff7',\n    borderRadius: scaleDimension(6),\n    zIndex: 2\n  },\n  cornerDotBR: {\n    position: 'absolute',\n    bottom: hp(2.5),\n    right: wp(4),\n    width: scaleDimension(12),\n    height: scaleDimension(12),\n    backgroundColor: '#ff2e7e',\n    borderRadius: scaleDimension(6),\n    zIndex: 2\n  },\n  scrollContent: {\n    flexGrow: 1,\n    paddingBottom: height * 0.04\n  },\n  audioContainer: {\n    width: '100%',\n    alignItems: 'center',\n    paddingVertical: 10,\n    backgroundColor: '#0a0a23',\n    borderBottomWidth: 1,\n    borderBottomColor: '#18182e'\n  },\n  audioButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    width: '90%',\n    backgroundColor: '#18182e',\n    borderRadius: 10,\n    borderWidth: 2,\n    borderColor: '#00fff7',\n    padding: 12\n  },\n  audioText: {\n    color: '#fff',\n    fontFamily: pixelFont,\n    fontSize: 20\n  },\n  audioIcon: {\n    width: 32,\n    height: 32,\n    marginLeft: 8\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","createContext","useContext","useRef","View","Text","StyleSheet","Image","Dimensions","TouchableOpacity","Modal","TextInput","Pressable","Platform","SafeAreaView","ActivityIndicator","ScrollView","Animated","RetroButton","userPinkIcon","auth","db","storage","updateProfile","onAuthStateChanged","signOut","ref","uploadBytes","getDownloadURL","getStorage","ImagePicker","doc","getDoc","setDoc","increment","updateDoc","editarRosaIcon","screenWidth","width","screenHeight","height","wp","hp","SPACING","FONT_SIZES","scaleDimension","scaleFont","getResponsiveDimension","Audio","AsyncStorage","AudioContext","BottomTabBar","GAME_SCORES","getExpForLevel","SPECIAL_AVATARS","checkAndUpdateMissions","jsxDEV","_jsxDEV","Fragment","_Fragment","pixelFont","pixelStroke","textShadowOffset","textShadowColor","textShadowRadius","defaultAvatar","require","avatarOptions","audioOnIcon","audioOffIcon","audioGame","audioPapi","UserCacheContext","useUserCache","ProfileScreen","_ref","_this","navigation","isTab","_useState","_useState2","_slicedToArray","currentUser","setCurrentUser","_useState3","_useState4","username","setUsername","_useState5","_useState6","avatar","setAvatar","_useState7","_useState8","level","setLevel","_useState9","_useState0","exp","setExp","_useState1","_useState10","expMax","setExpMax","_useState11","_useState12","modalVisible","setModalVisible","_useState13","_useState14","editName","setEditName","_useState15","_useState16","editAvatar","setEditAvatar","_useState17","_useState18","selectedAvatarIndex","setSelectedAvatarIndex","_useState19","_useState20","loggingOut","setLoggingOut","_useState21","_useState22","userCache","setUserCache","_useContext","audioOn","toggleAudio","fadeAnim","Value","current","_useState23","_useState24","showAvatarModal","setShowAvatarModal","audioRef","audioElementRef","unsubscribe","_ref2","_asyncToGenerator","user","displayName","userLevel","userExp","userDoc","uid","exists","_data$level","_data$exp","data","avatarSpecial","specialImg","photoURL","uri","firestoreError","console","warn","replace","error","_x","apply","arguments","activeTab","getState","route","routes","index","name","openEdit","cache","pickImage","_ref3","OS","input","document","createElement","type","accept","onchange","_ref4","e","file","target","files","storageRef","url","merge","_x2","click","result","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","canceled","assets","length","image","response","fetch","blob","saveEdit","_ref5","newName","trim","changeAvatarWithAnimation","newAvatar","sequence","timing","toValue","duration","useNativeDriver","start","currentTime","volume","play","unloadAsync","_yield$Audio$Sound$cr","Sound","createAsync","sound","setVolumeAsync","playAsync","pause","style","flex","backgroundColor","children","styles","root","justifyContent","alignItems","title","concat","fileName","_jsxFileName","lineNumber","columnNumber","Provider","value","contentContainerStyle","scrollContent","paddingBottom","showsVerticalScrollIndicator","activeOpacity","onPress","avatarBox","opacity","source","resizeMode","usernameBox","levelBox","levelRow","levelText","expText","expBarBg","expBarFill","editBtn","disabled","flexDirection","editBtnText","editIcon","tintColor","logoutBtn","alignSelf","marginTop","textStyle","logoutBtnText","visible","transparent","animationType","loadingOverlay","loadingBox","loadingText","size","color","onRequestClose","modalOverlay","modalBox","fontFamily","modalTitle","modalAvatarRow","map","img","i","modalAvatarOption","modalAvatarActive","modalAvatarImg","modalInput","onChangeText","maxLength","placeholder","placeholderTextColor","autoFocus","editAvatarBtn","editAvatarBtnText","modalBtnRowColumn","cancelBtn","cancelBtnText","borderRadius","borderWidth","borderColor","src","paddingVertical","paddingHorizontal","fontSize","onTabPress","tab","navigate","addTrikiWinExp","_addTrikiWinExp","userRef","triki","newLevel","updates","special","find","a","statsRef","statsDoc","prev","victorias","derrotas","missionReward","create","paddingTop","Math","min","letterSpacing","marginBottom","textAlign","padding","shadowColor","shadowOpacity","shadowRadius","shadowOffset","marginVertical","max","overflow","bottomTab","tabBtn","minHeight","tabBtnActive","borderBottomWidth","borderBottomColor","tabIcon","gap","marginHorizontal","marginLeft","cornerDotTL","position","top","left","zIndex","cornerDotTR","right","cornerDotBL","bottom","cornerDotBR","flexGrow","audioContainer","audioButton","audioText","audioIcon"],"sources":["C:/Users/Administrator/Documents/Tricade/src/views/ProfileScreen.js"],"sourcesContent":["import React, { useState, useEffect, createContext, useContext, useRef } from 'react';\r\nimport { View, Text, StyleSheet, Image, Dimensions, TouchableOpacity, Modal, TextInput, Pressable, Platform, SafeAreaView, ActivityIndicator, ScrollView, Animated } from 'react-native';\r\nimport RetroButton from '../components/RetroButton';\r\nimport userPinkIcon from '../assets/user-pink.png';\r\nimport { auth, db, storage } from '../firebaseConfig';\r\nimport { updateProfile, onAuthStateChanged, signOut } from 'firebase/auth';\r\nimport { ref, uploadBytes, getDownloadURL, getStorage } from 'firebase/storage';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { doc, getDoc, setDoc, increment, updateDoc } from 'firebase/firestore';\r\nimport editarRosaIcon from '../assets/editar_rosa.png';\r\nimport {\r\n  screenWidth as width,\r\n  screenHeight as height,\r\n  wp,\r\n  hp,\r\n  SPACING,\r\n  FONT_SIZES,\r\n  scaleDimension,\r\n  scaleFont,\r\n  getResponsiveDimension\r\n} from '../utils/dimensions';\r\nimport { Audio } from 'expo-av';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { AudioContext } from '../../App';\r\nimport BottomTabBar from '../components/BottomTabBar';\r\nimport { GAME_SCORES, getExpForLevel, SPECIAL_AVATARS } from '../utils/scoreConfig';\r\nimport { checkAndUpdateMissions } from '../utils/missions';\r\n\r\nconst pixelFont = 'PressStart2P_400Regular';\r\n\r\nconst pixelStroke = [\r\n  { textShadowOffset: { width: -4, height: 0 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: 4, height: 0 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: 0, height: -4 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: 0, height: 4 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: -4, height: -4 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: 4, height: -4 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: -4, height: 4 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n  { textShadowOffset: { width: 4, height: 4 }, textShadowColor: '#000', textShadowRadius: 0 },\r\n];\r\n\r\nconst defaultAvatar = require('../assets/user-pink.png');\r\nconst avatarOptions = [\r\n  require('../assets/user-blue.png'),\r\n  require('../assets/user-pink.png'),\r\n];\r\n\r\nconst audioOnIcon = require('../assets/audio-on.png');\r\nconst audioOffIcon = require('../assets/audio-off.png');\r\nconst audioGame = require('../assets/audio-game.mp3');\r\nconst audioPapi = require('../assets/audio-papi.mp3');\r\n\r\n// Contexto global para el usuario\r\nexport const UserCacheContext = createContext();\r\nexport function useUserCache() { return useContext(UserCacheContext); }\r\n\r\nexport default function ProfileScreen({ navigation, isTab }) {\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [username, setUsername] = useState('');\r\n  const [avatar, setAvatar] = useState(userPinkIcon);\r\n  const [level, setLevel] = useState(0);\r\n  const [exp, setExp] = useState(0);\r\n  const [expMax, setExpMax] = useState(600);\r\n\r\n  // Modal ediciÃ³n\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [editName, setEditName] = useState('');\r\n  const [editAvatar, setEditAvatar] = useState(null);\r\n  const [selectedAvatarIndex, setSelectedAvatarIndex] = useState(0);\r\n\r\n  const [loggingOut, setLoggingOut] = useState(false);\r\n\r\n  // Nuevo: usar cachÃ© global\r\n  const [userCache, setUserCache] = useState(null);\r\n\r\n  const { audioOn, toggleAudio } = useContext(AudioContext);\r\n\r\n  const fadeAnim = useRef(new Animated.Value(1)).current;\r\n\r\n  const [showAvatarModal, setShowAvatarModal] = useState(false);\r\n  const audioRef = useRef(null);\r\n  const audioElementRef = useRef(null); // Para web\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\r\n      try {\r\n        if (user) {\r\n          setCurrentUser(user);\r\n          let displayName = user.displayName;\r\n          let userLevel = 0;\r\n          let userExp = 0;\r\n          // Si no hay nombre en Auth, intentar obtenerlo desde Firestore\r\n          try {\r\n            const userDoc = await getDoc(doc(db, 'users', user.uid));\r\n            if (userDoc.exists()) {\r\n              const data = userDoc.data();\r\n              displayName = data.displayName || displayName;\r\n              userLevel = data.level ?? 0;\r\n              userExp = data.exp ?? 0;\r\n              // Nuevo: priorizar avatar especial (string a require)\r\n              if (data.avatarSpecial) {\r\n                let specialImg = null;\r\n                if (data.avatarSpecial === 'hidden.1.jpg') specialImg = require('../assets/hidden.1.jpg');\r\n                else if (data.avatarSpecial === 'hidden.2.jpg') specialImg = require('../assets/hidden.2.jpg');\r\n                else if (data.avatarSpecial === 'hidden.3.jpg') specialImg = require('../assets/hidden.3.jpg');\r\n                if (specialImg) setAvatar(specialImg);\r\n                else if (user.photoURL) setAvatar({ uri: user.photoURL });\r\n                else setAvatar(userPinkIcon);\r\n              } else if (user.photoURL) {\r\n                setAvatar({ uri: user.photoURL });\r\n              } else {\r\n                setAvatar(userPinkIcon);\r\n              }\r\n              // Actualizar Auth con el nombre de Firestore\r\n              if (displayName && user.displayName !== displayName) {\r\n                await updateProfile(user, { displayName });\r\n              }\r\n            }\r\n          } catch (firestoreError) {\r\n            console.warn('Error al conectar con Firestore:', firestoreError);\r\n            // Usar datos locales si Firestore no estÃ¡ disponible\r\n            if (user.photoURL) {\r\n              setAvatar({ uri: user.photoURL });\r\n            } else {\r\n              setAvatar(userPinkIcon);\r\n            }\r\n          }\r\n          setUsername(displayName || '');\r\n          setEditName(displayName || '');\r\n          setLevel(userLevel);\r\n          setExp(userExp);\r\n          // Guardar en cachÃ© global\r\n          setUserCache({\r\n            uid: user.uid,\r\n            displayName,\r\n            level: userLevel,\r\n            exp: userExp,\r\n            photoURL: user.photoURL || null,\r\n            avatar: user.photoURL ? { uri: user.photoURL } : userPinkIcon\r\n          });\r\n        } else {\r\n          if (!isTab) {\r\n            navigation.replace && navigation.replace('Login');\r\n          } else {\r\n            setCurrentUser(null);\r\n          }\r\n          setUserCache(null);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error en la autenticaciÃ³n:', error);\r\n        // Manejar el error de manera apropiada\r\n        if (!isTab) {\r\n          navigation.replace && navigation.replace('Login');\r\n        } else {\r\n          setCurrentUser(null);\r\n        }\r\n        setUserCache(null);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [navigation, isTab]);\r\n\r\n  // Detectar pantalla activa por navigation (si navigation.getState existe)\r\n  let activeTab = 'user';\r\n  if (navigation && navigation.getState) {\r\n    const route = navigation.getState().routes[navigation.getState().index];\r\n    if (route && route.name === 'Profile') activeTab = 'user';\r\n    else if (route && route.name === 'Games') activeTab = 'home';\r\n    else if (route && route.name === 'Home') activeTab = 'trophy';\r\n  }\r\n\r\n  // Usar cachÃ© global para el modal\r\n  const openEdit = () => {\r\n    const cache = userCache || {};\r\n    setEditName(cache.displayName || username);\r\n    setEditAvatar(cache.avatar || avatar);\r\n    setModalVisible(true);\r\n  };\r\n\r\n  const pickImage = async () => {\r\n    if (Platform.OS === 'web') {\r\n      // En web, usamos un input file nativo\r\n      const input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.accept = 'image/*';\r\n      input.onchange = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (file) {\r\n          try {\r\n            const storage = getStorage();\r\n            const storageRef = ref(storage, `avatars/${currentUser.uid}.jpg`);\r\n            await uploadBytes(storageRef, file);\r\n            const url = await getDownloadURL(storageRef);\r\n            await updateProfile(currentUser, { photoURL: url });\r\n            setAvatar({ uri: url });\r\n            // Guarda la URL en Firestore\r\n            if (currentUser && currentUser.uid) {\r\n              await setDoc(\r\n                doc(db, 'users', currentUser.uid),\r\n                { photoURL: url },\r\n                { merge: true }\r\n              );\r\n            }\r\n          } catch (error) {\r\n            console.error('Error al subir la imagen:', error);\r\n          }\r\n        }\r\n      };\r\n      input.click();\r\n    } else {\r\n      // En mÃ³vil, usamos expo-image-picker\r\n      let result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsEditing: true,\r\n        aspect: [1, 1],\r\n        quality: 0.7,\r\n      });\r\n      if (!result.canceled && result.assets && result.assets.length > 0) {\r\n        const image = result.assets[0];\r\n        try {\r\n          const storage = getStorage();\r\n          const storageRef = ref(storage, `avatars/${currentUser.uid}.jpg`);\r\n          const response = await fetch(image.uri);\r\n          const blob = await response.blob();\r\n          await uploadBytes(storageRef, blob);\r\n          const url = await getDownloadURL(storageRef);\r\n          await updateProfile(currentUser, { photoURL: url });\r\n          setAvatar({ uri: url });\r\n          // Guarda la URL en Firestore\r\n          if (currentUser && currentUser.uid) {\r\n            await setDoc(\r\n              doc(db, 'users', currentUser.uid),\r\n              { photoURL: url },\r\n              { merge: true }\r\n            );\r\n          }\r\n        } catch (error) {\r\n          console.error('Error al subir la imagen:', error);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const saveEdit = async () => {\r\n    const newName = editName.trim() ? editName : username;\r\n    setUsername(newName);\r\n    setAvatar(editAvatar);\r\n    setModalVisible(false);\r\n    // Actualiza el nombre en Firebase Auth\r\n    await updateProfile(currentUser, { displayName: newName });\r\n    // Actualiza el nombre en Firestore\r\n    if (currentUser && currentUser.uid) {\r\n      await setDoc(\r\n        doc(db, 'users', currentUser.uid),\r\n        { displayName: newName },\r\n        { merge: true }\r\n      );\r\n    }\r\n  };\r\n\r\n  // FunciÃ³n para cambiar el avatar con animaciÃ³n\r\n  const changeAvatarWithAnimation = (newAvatar) => {\r\n    Animated.sequence([\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 0,\r\n        duration: 500,\r\n        useNativeDriver: true,\r\n      }),\r\n      Animated.timing(fadeAnim, {\r\n        toValue: 1,\r\n        duration: 500,\r\n        useNativeDriver: true,\r\n      }),\r\n    ]).start();\r\n    setAvatar(newAvatar);\r\n  };\r\n\r\n  // Reproducir audio al abrir el modal de avatar (web y mÃ³vil)\r\n  useEffect(() => {\r\n    if (showAvatarModal) {\r\n      if (Platform.OS === 'web') {\r\n        // Web: usar <audio>\r\n        if (audioElementRef.current) {\r\n          audioElementRef.current.currentTime = 0;\r\n          audioElementRef.current.volume = 0.4;\r\n          audioElementRef.current.play();\r\n        }\r\n      } else {\r\n        // MÃ³vil: usar expo-av\r\n        (async () => {\r\n          if (audioRef.current) {\r\n            await audioRef.current.unloadAsync();\r\n          }\r\n          const { sound } = await Audio.Sound.createAsync(audioPapi);\r\n          audioRef.current = sound;\r\n          await sound.setVolumeAsync(0.4);\r\n          await sound.playAsync();\r\n        })();\r\n      }\r\n    } else {\r\n      if (Platform.OS === 'web') {\r\n        if (audioElementRef.current) {\r\n          audioElementRef.current.pause();\r\n          audioElementRef.current.currentTime = 0;\r\n        }\r\n      } else {\r\n        if (audioRef.current) {\r\n          audioRef.current.unloadAsync();\r\n          audioRef.current = null;\r\n        }\r\n      }\r\n    }\r\n    return () => {\r\n      if (Platform.OS === 'web') {\r\n        if (audioElementRef.current) {\r\n          audioElementRef.current.pause();\r\n          audioElementRef.current.currentTime = 0;\r\n        }\r\n      } else {\r\n        if (audioRef.current) {\r\n          audioRef.current.unloadAsync();\r\n          audioRef.current = null;\r\n        }\r\n      }\r\n    };\r\n  }, [showAvatarModal]);\r\n\r\n  // Si no hay usuario, mostrar pantalla de carga o nada\r\n  if (!currentUser) {\r\n    return (\r\n      <SafeAreaView style={{ flex: 1, backgroundColor: '#0a0a23' }}>\r\n        <View style={[styles.root, { justifyContent: 'center', alignItems: 'center' }]}>\r\n          <Text style={[styles.title, ...pixelStroke]}>Cargando...</Text>\r\n        </View>\r\n      </SafeAreaView>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <UserCacheContext.Provider value={userCache}>\r\n      <SafeAreaView style={{ flex: 1, backgroundColor: '#0a0a23' }}>\r\n        <View style={styles.root}>\r\n          <ScrollView contentContainerStyle={[styles.scrollContent, { paddingBottom: 120 }]} showsVerticalScrollIndicator={false}>\r\n            {/* TÃ­tulo */}\r\n            <Text style={[styles.title, ...pixelStroke]}>PERFIL DE USUARIO</Text>\r\n\r\n            {/* Avatar */}\r\n            <TouchableOpacity activeOpacity={0.8} onPress={() => setShowAvatarModal(true)}>\r\n              <Animated.View style={[styles.avatarBox, { opacity: fadeAnim }]}> \r\n                <Image source={avatar} style={styles.avatar} resizeMode=\"contain\" />\r\n              </Animated.View>\r\n            </TouchableOpacity>\r\n\r\n            {/* Nombre de usuario */}\r\n            <View style={styles.usernameBox}>\r\n              <Text style={[styles.username, ...pixelStroke]}>{username}</Text>\r\n            </View>\r\n\r\n            {/* Nivel y barra de experiencia */}\r\n            <View style={styles.levelBox}>\r\n              <View style={styles.levelRow}>\r\n                <Text style={styles.levelText}>Nivel {level}</Text>\r\n                <Text style={styles.expText}>Exp {exp}/{expMax}</Text>\r\n              </View>\r\n              <View style={styles.expBarBg}>\r\n                <View style={[styles.expBarFill, { width: `${(exp/expMax)*100}%` }]} />\r\n              </View>\r\n            </View>\r\n\r\n            {/* BotÃ³n Editar perfil */}\r\n            <TouchableOpacity style={styles.editBtn} activeOpacity={0.7} onPress={openEdit} disabled={!currentUser}>\r\n              <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'center' }}>\r\n                <Text style={styles.editBtnText}>Editar perfil</Text>\r\n                <Image source={editarRosaIcon} style={styles.editIcon} resizeMode=\"contain\" />\r\n              </View>\r\n            </TouchableOpacity>\r\n\r\n            {/* BotÃ³n de audio */}\r\n            <TouchableOpacity style={styles.editBtn} activeOpacity={0.7} onPress={toggleAudio}>\r\n              <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'center' }}>\r\n                <Text style={styles.editBtnText}>{audioOn ? 'Apagar sonido' : 'Encender sonido'}</Text>\r\n                <Image \r\n                  source={audioOn ? audioOnIcon : audioOffIcon} \r\n                  style={[styles.editIcon, { tintColor: audioOn ? '#ff2e7e' : '#aaa' }]} \r\n                  resizeMode=\"contain\" \r\n                />\r\n              </View>\r\n            </TouchableOpacity>\r\n\r\n            {/* BotÃ³n Salir */}\r\n            {!loggingOut && (\r\n              <RetroButton \r\n                title=\"Salir\" \r\n                onPress={async () => {\r\n                  setLoggingOut(true);\r\n                  await signOut(auth);\r\n                  setLoggingOut(false);\r\n                  if (!isTab) {\r\n                    navigation.replace && navigation.replace('Login');\r\n                  } else {\r\n                    setCurrentUser(null);\r\n                  }\r\n                }} \r\n                style={[styles.logoutBtn, { alignSelf: 'center', width: '90%', marginTop: 18 }]}\r\n                textStyle={styles.logoutBtnText}\r\n              />\r\n            )}\r\n\r\n            {/* Loading modal al cerrar sesiÃ³n */}\r\n            <Modal\r\n              visible={loggingOut}\r\n              transparent\r\n              animationType=\"fade\"\r\n            >\r\n              <View style={styles.loadingOverlay}>\r\n                <View style={styles.loadingBox}>\r\n                  <Text style={styles.loadingText}>Cerrando sesiÃ³n...</Text>\r\n                  <View style={{ marginTop: 18 }}>\r\n                    <ActivityIndicator size=\"large\" color=\"#ff2e7e\" />\r\n                  </View>\r\n                </View>\r\n              </View>\r\n            </Modal>\r\n\r\n            {/* Modal ediciÃ³n perfil */}\r\n            <Modal\r\n              visible={modalVisible}\r\n              animationType=\"fade\"\r\n              transparent\r\n              onRequestClose={() => setModalVisible(false)}\r\n            >\r\n              <View style={styles.modalOverlay}>\r\n                <View style={styles.modalBox}>\r\n                  {(!username || !avatar) ? (\r\n                    <View style={{ alignItems: 'center', justifyContent: 'center', height: 120 }}>\r\n                      <ActivityIndicator size=\"large\" color=\"#00fff7\" />\r\n                      <Text style={{ color: '#00fff7', fontFamily: pixelFont, marginTop: 18 }}>Cargando perfil...</Text>\r\n                    </View>\r\n                  ) : (\r\n                    <>\r\n                      <Text style={[styles.modalTitle, ...pixelStroke]}>Editar perfil</Text>\r\n                      <View style={styles.modalAvatarRow}>\r\n                        {avatarOptions.map((img, i) => (\r\n                          <Pressable key={i} onPress={() => setEditAvatar(img)} style={[styles.modalAvatarOption, editAvatar === img && styles.modalAvatarActive]}> \r\n                            <Image source={img} style={styles.modalAvatarImg} resizeMode=\"contain\" />\r\n                          </Pressable>\r\n                        ))}\r\n                      </View>\r\n                      <TextInput\r\n                        style={styles.modalInput}\r\n                        value={editName}\r\n                        onChangeText={setEditName}\r\n                        maxLength={16}\r\n                        placeholder=\"Nombre de usuario\"\r\n                        placeholderTextColor=\"#00fff7\"\r\n                        autoFocus\r\n                      />\r\n                      <TouchableOpacity onPress={pickImage} style={styles.editAvatarBtn}>\r\n                        <Text style={styles.editAvatarBtnText}>Elegir foto de galerÃ­a</Text>\r\n                      </TouchableOpacity>\r\n                      <View style={styles.modalBtnRowColumn}>\r\n                        <RetroButton title=\"Guardar\" onPress={saveEdit} />\r\n                        <RetroButton title=\"Cancelar\" onPress={() => setModalVisible(false)} style={styles.cancelBtn} textStyle={styles.cancelBtnText} />\r\n                      </View>\r\n                    </>\r\n                  )}\r\n                </View>\r\n              </View>\r\n            </Modal>\r\n\r\n            {/* Modal para ver avatar grande */}\r\n            <Modal\r\n              visible={showAvatarModal}\r\n              transparent\r\n              animationType=\"fade\"\r\n              onRequestClose={() => setShowAvatarModal(false)}\r\n            >\r\n              <View style={styles.modalOverlay}>\r\n                <View style={{ alignItems: 'center', justifyContent: 'center' }}>\r\n                  <Image source={avatar} style={{ width: 220, height: 220, borderRadius: 24, borderWidth: 4, borderColor: '#00fff7', backgroundColor: '#23233a' }} resizeMode=\"contain\" />\r\n                  {/* Audio para web */}\r\n                  {Platform.OS === 'web' && (\r\n                    <audio ref={audioElementRef} src={require('../assets/audio-papi.mp3')} />\r\n                  )}\r\n                  <TouchableOpacity onPress={() => setShowAvatarModal(false)} style={{ marginTop: 24, backgroundColor: '#ff2e7e', borderRadius: 12, paddingVertical: 10, paddingHorizontal: 32 }}>\r\n                    <Text style={{ color: '#fff', fontFamily: pixelFont, fontSize: 16 }}>Cerrar</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n              </View>\r\n            </Modal>\r\n          </ScrollView>\r\n          {/* MenÃº inferior siempre visible */}\r\n          {(!isTab) && (\r\n            <BottomTabBar\r\n              activeTab={activeTab}\r\n              onTabPress={(tab) => {\r\n                if (tab === 'trophy') navigation.navigate('Home');\r\n                if (tab === 'home') navigation.navigate('Games');\r\n                if (tab === 'user') navigation.navigate('Profile');\r\n              }}\r\n            />\r\n          )}\r\n        </View>\r\n      </SafeAreaView>\r\n    </UserCacheContext.Provider>\r\n  );\r\n}\r\n\r\nexport async function addTrikiWinExp() {\r\n  if (!auth.currentUser) return;\r\n  const userRef = doc(db, 'users', auth.currentUser.uid);\r\n  const userDoc = await getDoc(userRef);\r\n  let exp = 0, level = 0;\r\n  if (userDoc.exists()) {\r\n    exp = userDoc.data().exp || 0;\r\n    level = userDoc.data().level || 0;\r\n  }\r\n  // Sumar puntos por victoria en Triki\r\n  exp += GAME_SCORES.triki;\r\n  let newLevel = level;\r\n  let expMax = getExpForLevel(newLevel + 1);\r\n  // Subir solo un nivel por victoria\r\n  if (exp >= expMax) {\r\n    exp -= expMax;\r\n    newLevel += 1;\r\n  }\r\n  // Cambiar avatar si corresponde\r\n  let updates = { exp, level: newLevel };\r\n  const special = SPECIAL_AVATARS.find(a => a.level === newLevel);\r\n  if (special) {\r\n    updates.photoURL = null;\r\n    updates.avatarSpecial = special.image; // Store only the filename string\r\n  }\r\n  await setDoc(userRef, updates, { merge: true });\r\n\r\n  // Actualizar estadÃ­sticas y trofeos\r\n  const statsRef = doc(db, 'users', auth.currentUser.uid, 'trikiStats', 'stats');\r\n  const statsDoc = await getDoc(statsRef);\r\n  let prev = { victorias: 0, derrotas: 0 };\r\n  if (statsDoc.exists()) {\r\n    prev = statsDoc.data();\r\n  }\r\n  await setDoc(statsRef, {\r\n    victorias: prev.victorias + 1,\r\n    derrotas: prev.derrotas\r\n  }, { merge: true });\r\n\r\n  // Verificar misiones\r\n  const missionReward = await checkAndUpdateMissions(\r\n    auth.currentUser.uid,\r\n    'TRIKI',\r\n    {\r\n      victorias: prev.victorias + 1,\r\n      derrotas: prev.derrotas\r\n    }\r\n  );\r\n\r\n  // Si hay recompensa por misiones, sumarla al nivel\r\n  if (missionReward > 0) {\r\n    await updateDoc(userRef, { level: increment(missionReward) });\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  root: {\r\n    flex: 1,\r\n    backgroundColor: '#0a0a23',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-start',\r\n    paddingTop: height * 0.04,\r\n    paddingBottom: 0,\r\n    width: '100%',\r\n    alignSelf: 'center',\r\n  },\r\n  title: {\r\n    color: '#fff',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.07, 22),\r\n    letterSpacing: 2,\r\n    marginBottom: height * 0.025,\r\n    textAlign: 'center',\r\n  },\r\n  avatarBox: {\r\n    borderWidth: width * 0.015,\r\n    borderColor: '#00fff7',\r\n    borderRadius: width * 0.08,\r\n    padding: width * 0.02,\r\n    backgroundColor: '#23233a',\r\n    alignSelf: 'center',\r\n    marginBottom: height * 0.018,\r\n    shadowColor: '#00fff7',\r\n    shadowOpacity: 0.45,\r\n    shadowRadius: 16,\r\n    shadowOffset: { width: 0, height: 0 },\r\n  },\r\n  avatar: {\r\n    width: Math.min(width * 0.28, 80),\r\n    height: Math.min(width * 0.28, 80),\r\n    borderRadius: width * 0.06,\r\n  },\r\n  usernameBox: {\r\n    alignSelf: 'center',\r\n    marginVertical: height * 0.012,\r\n    borderWidth: width * 0.01,\r\n    borderColor: '#00fff7',\r\n    borderRadius: width * 0.03,\r\n    paddingHorizontal: width * 0.04,\r\n    paddingVertical: height * 0.01,\r\n    backgroundColor: '#23233a',\r\n  },\r\n  username: {\r\n    color: '#00fff7',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.055, 18),\r\n    textAlign: 'center',\r\n  },\r\n  levelBox: {\r\n    width: '90%',\r\n    alignSelf: 'center',\r\n    marginVertical: height * 0.018,\r\n    borderWidth: width * 0.01,\r\n    borderColor: '#00fff7',\r\n    borderRadius: width * 0.04,\r\n    backgroundColor: '#23233a',\r\n    padding: width * 0.03,\r\n  },\r\n  levelRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 6,\r\n  },\r\n  levelText: {\r\n    color: '#ff2e7e',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.045, 14),\r\n  },\r\n  expText: {\r\n    color: '#ff2e7e',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.035, 12),\r\n  },\r\n  expBarBg: {\r\n    width: '100%',\r\n    height: Math.max(10, height * 0.015),\r\n    backgroundColor: '#101926',\r\n    borderRadius: width * 0.03,\r\n    overflow: 'hidden',\r\n    borderWidth: width * 0.008,\r\n    borderColor: '#ff2e7e',\r\n  },\r\n  expBarFill: {\r\n    height: '100%',\r\n    backgroundColor: '#ff2e7e',\r\n    borderRadius: width * 0.03,\r\n  },\r\n  editBtn: {\r\n    width: '90%',\r\n    alignSelf: 'center',\r\n    marginTop: height * 0.012,\r\n    marginBottom: height * 0.012,\r\n    borderWidth: width * 0.01,\r\n    borderColor: '#00fff7',\r\n    borderRadius: width * 0.03,\r\n    backgroundColor: '#101926',\r\n    paddingVertical: height * 0.018,\r\n    paddingHorizontal: width * 0.04,\r\n  },\r\n  editBtnText: {\r\n    color: '#fff',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.038, 13),\r\n    textAlign: 'center',\r\n  },\r\n  bottomTab: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    width: '94%',\r\n    backgroundColor: 'transparent',\r\n    borderRadius: width * 0.045,\r\n    borderWidth: width * 0.01,\r\n    borderColor: '#00fff7',\r\n    paddingVertical: height * 0.012,\r\n    paddingHorizontal: width * 0.045,\r\n    alignSelf: 'center',\r\n    marginTop: 'auto',\r\n    shadowColor: '#00fff7',\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 10,\r\n    shadowOffset: { width: 0, height: 0 },\r\n  },\r\n  tabBtn: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    paddingVertical: height * 0.012,\r\n    minHeight: 40,\r\n  },\r\n  tabBtnActive: {\r\n    borderBottomWidth: 4,\r\n    borderBottomColor: '#ff2e7e',\r\n    shadowColor: '#ff2e7e',\r\n    shadowOpacity: 0.7,\r\n    shadowRadius: 10,\r\n    shadowOffset: { width: 0, height: 0 },\r\n  },\r\n  tabIcon: {\r\n    width: width * 0.09,\r\n    height: width * 0.09,\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(10,10,35,0.92)',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  modalBox: {\r\n    width: Math.min(width * 0.88, 340),\r\n    backgroundColor: '#23233a',\r\n    borderRadius: Math.max(18, width * 0.045),\r\n    borderWidth: 4,\r\n    borderColor: '#00fff7',\r\n    padding: 22,\r\n    alignItems: 'center',\r\n    shadowColor: '#00fff7',\r\n    shadowOpacity: 0.45,\r\n    shadowRadius: 16,\r\n    shadowOffset: { width: 0, height: 0 },\r\n  },\r\n  modalTitle: {\r\n    color: '#ff2e7e',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.055, 22),\r\n    marginBottom: 18,\r\n    textAlign: 'center',\r\n  },\r\n  modalAvatarRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginBottom: 18,\r\n    gap: 12,\r\n  },\r\n  modalAvatarOption: {\r\n    borderWidth: 2,\r\n    borderColor: '#00fff7',\r\n    borderRadius: 16,\r\n    padding: 4,\r\n    marginHorizontal: 6,\r\n    backgroundColor: '#101926',\r\n  },\r\n  modalAvatarActive: {\r\n    borderColor: '#ff2e7e',\r\n    backgroundColor: '#18182e',\r\n    shadowColor: '#ff2e7e',\r\n    shadowOpacity: 0.7,\r\n    shadowRadius: 8,\r\n    shadowOffset: { width: 0, height: 0 },\r\n  },\r\n  modalAvatarImg: {\r\n    width: 48,\r\n    height: 48,\r\n    borderRadius: 12,\r\n  },\r\n  modalInput: {\r\n    width: '90%',\r\n    borderWidth: 2,\r\n    borderColor: '#00fff7',\r\n    borderRadius: 10,\r\n    backgroundColor: '#101926',\r\n    color: '#00fff7',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.045, 18),\r\n    paddingVertical: 10,\r\n    paddingHorizontal: 12,\r\n    marginBottom: 18,\r\n    textAlign: 'center',\r\n  },\r\n  modalBtnRowColumn: {\r\n    flexDirection: 'column',\r\n    width: '100%',\r\n    gap: 10,\r\n    marginTop: 8,\r\n  },\r\n  editAvatarBtn: {\r\n    marginTop: 10,\r\n    marginBottom: 10,\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 18,\r\n    borderRadius: 8,\r\n    borderWidth: 2,\r\n    borderColor: '#00fff7',\r\n    backgroundColor: '#181828',\r\n    alignSelf: 'center',\r\n  },\r\n  editAvatarBtnText: {\r\n    color: '#00fff7',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.038, 16),\r\n    textAlign: 'center',\r\n  },\r\n  cancelBtn: {\r\n    backgroundColor: '#ff2e7e',\r\n    borderColor: '#ff2e7e',\r\n    marginTop: 6,\r\n  },\r\n  cancelBtnText: {\r\n    color: '#fff',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.038, 16),\r\n    textAlign: 'center',\r\n  },\r\n  logoutBtn: {\r\n    backgroundColor: '#ff2e7e',\r\n    borderColor: '#ff2e7e',\r\n    marginTop: 16,\r\n  },\r\n  logoutBtnText: {\r\n    color: '#fff',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.038, 16),\r\n    textAlign: 'center',\r\n  },\r\n  loadingOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(10,10,35,0.92)',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  loadingBox: {\r\n    backgroundColor: '#23233a',\r\n    borderRadius: 18,\r\n    borderWidth: 4,\r\n    borderColor: '#ff2e7e',\r\n    padding: 32,\r\n    alignItems: 'center',\r\n    shadowColor: '#ff2e7e',\r\n    shadowOpacity: 0.45,\r\n    shadowRadius: 16,\r\n    shadowOffset: { width: 0, height: 0 },\r\n  },\r\n  loadingText: {\r\n    color: '#ff2e7e',\r\n    fontFamily: pixelFont,\r\n    fontSize: Math.min(width * 0.045, 18),\r\n    textAlign: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  editIcon: {\r\n    width: 28,\r\n    height: 28,\r\n    marginLeft: 14,\r\n    marginBottom: -3,\r\n  },\r\n  cornerDotTL: {\r\n    position: 'absolute',\r\n    top: hp(2.5),\r\n    left: wp(4),\r\n    width: scaleDimension(12),\r\n    height: scaleDimension(12),\r\n    backgroundColor: '#ff2e7e',\r\n    borderRadius: scaleDimension(6),\r\n    zIndex: 2,\r\n  },\r\n  cornerDotTR: {\r\n    position: 'absolute',\r\n    top: hp(2.5),\r\n    right: wp(4),\r\n    width: scaleDimension(12),\r\n    height: scaleDimension(12),\r\n    backgroundColor: '#00fff7',\r\n    borderRadius: scaleDimension(6),\r\n    zIndex: 2,\r\n  },\r\n  cornerDotBL: {\r\n    position: 'absolute',\r\n    bottom: hp(2.5),\r\n    left: wp(4),\r\n    width: scaleDimension(12),\r\n    height: scaleDimension(12),\r\n    backgroundColor: '#00fff7',\r\n    borderRadius: scaleDimension(6),\r\n    zIndex: 2,\r\n  },\r\n  cornerDotBR: {\r\n    position: 'absolute',\r\n    bottom: hp(2.5),\r\n    right: wp(4),\r\n    width: scaleDimension(12),\r\n    height: scaleDimension(12),\r\n    backgroundColor: '#ff2e7e',\r\n    borderRadius: scaleDimension(6),\r\n    zIndex: 2,\r\n  },\r\n  scrollContent: {\r\n    flexGrow: 1,\r\n    paddingBottom: height * 0.04,\r\n  },\r\n  audioContainer: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    paddingVertical: 10,\r\n    backgroundColor: '#0a0a23',\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#18182e',\r\n  },\r\n  audioButton: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'space-between',\r\n    width: '90%',\r\n    backgroundColor: '#18182e',\r\n    borderRadius: 10,\r\n    borderWidth: 2,\r\n    borderColor: '#00fff7',\r\n    padding: 12,\r\n  },\r\n  audioText: {\r\n    color: '#fff',\r\n    fontFamily: pixelFont,\r\n    fontSize: 20,\r\n  },\r\n  audioIcon: {\r\n    width: 32,\r\n    height: 32,\r\n    marginLeft: 8,\r\n  },\r\n}); "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}